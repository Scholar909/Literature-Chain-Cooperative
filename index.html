<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geometric Diagram Replication</title>
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f8f8f8;
            font-family: 'EB Garamond', serif;
        }
        #container {
            background-color: white;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-radius: 12px;
        }
        canvas {
            border: 1px solid #eee;
        }
        .controls {
            margin-top: 25px;
        }
        button {
            padding: 12px 24px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            background-color: #333;
            color: white;
            border: none;
            border-radius: 6px;
            transition: all 0.2s;
        }
        button:hover {
            background-color: #000;
            transform: translateY(-1px);
        }
    </style>
</head>
<body>

    <div id="container">
        <canvas id="diagramCanvas" width="700" height="500"></canvas>
    </div>

    <div class="controls">
        <button id="downloadBtn">Download Image</button>
    </div>

    <script>
        const canvas = document.getElementById('diagramCanvas');
        const ctx = canvas.getContext('2d');

        function draw() {
            const originX = 60;
            const originY = 430;

            // Clear and set background
            ctx.fillStyle = "white";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Styling for lines
            ctx.strokeStyle = 'black';
            ctx.fillStyle = 'black';
            ctx.lineJoin = 'round';
            ctx.font = 'italic 26px "EB Garamond", serif';

            // 1. DRAW THE FOUR LINES
            // Line 4: Normal X-Axis
            ctx.beginPath();
            ctx.lineWidth = 2;
            ctx.setLineDash([]);
            ctx.moveTo(originX, originY);
            ctx.lineTo(600, originY);
            ctx.stroke();
            // X-axis label
            ctx.fillText('x axis', 530, originY + 35);

            // Line 1: Light (Dashed) top line - Adjusted to touch left side of oval
            ctx.beginPath();
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            ctx.moveTo(originX, originY);
            ctx.lineTo(500, 10); 
            ctx.stroke();

            // Line 3: Light (Dashed) third line - Adjusted to touch right side of oval
            ctx.beginPath();
            ctx.moveTo(originX, originY);
            ctx.lineTo(650, 278);
            ctx.stroke();

            // Line 2: Normal second line (The main diagonal)
            ctx.setLineDash([]);
            ctx.beginPath();
            ctx.lineWidth = 2;
            ctx.moveTo(originX, originY);
            ctx.lineTo(600, 120);
            ctx.stroke();

            // 2. DRAW THE OVAL (on Line 2, bounded by Lines 1 and 3)
            ctx.beginPath();
            ctx.ellipse(420, 230, 150, 100, -0.5, 0, 2 * Math.PI);
            ctx.lineWidth = 2;
            ctx.stroke();

            // 3. ANGLE THETA (θ)
            ctx.beginPath();
            ctx.arc(originX, originY, 80, -Math.atan2(310, 540), 0);
            ctx.stroke();
            ctx.fillText('θ', originX + 90, originY - 25);

            // 4. FIRST δr ARC (Between angle and oval on line 2)
            ctx.beginPath();
            ctx.arc(170, 368, 15, -1.8, 1.2);
            ctx.stroke();
            ctx.fillText('δr', 160, 345);

            // 5. INTERNAL ARCS AND LABELS (Smaller, first-quadrant sector style)
            // Arc PR
            ctx.beginPath();
            ctx.arc(370, 255, 25, -Math.PI/2, 0); 
            ctx.stroke();
            ctx.fillText('P', 375, 285);
            ctx.fillText('R', 335, 235);

            // Arc SQ
            ctx.beginPath();
            ctx.arc(445, 210, 25, -Math.PI/2, 0);
            ctx.stroke();
            ctx.fillText('S', 480, 230);
            ctx.fillText('Q', 450, 175);

            // Second δr label between internal arcs
            ctx.fillText('δr', 400, 245);
        }

        document.getElementById('downloadBtn').addEventListener('click', () => {
            const link = document.createElement('a');
            link.download = 'mathematical_diagram.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        });

        // Ensure font is loaded before drawing
        document.fonts.ready.then(draw);
    </script>
</body>
</html>
