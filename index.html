<!DOCTYPE html>
<html>
<head>
    <style>
        body { display: flex; flex-direction: column; align-items: center; background: #fff; font-family: "Times New Roman", serif; }
        canvas { border: 1px solid #000; margin-top: 20px; }
        button { margin-top: 15px; padding: 10px 25px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <canvas id="c" width="600" height="500"></canvas>
    <button onclick="download()">Download Image</button>

    <script>
        const canvas = document.getElementById('c');
        const ctx = canvas.getContext('2d');
        const ox = 300, oy = 420, s = 85;

        function draw() {
            ctx.fillStyle = "white"; ctx.fillRect(0,0,600,500);
            ctx.strokeStyle = "black"; ctx.lineWidth = 2; ctx.fillStyle = "black";

            // 1. Shaded Region (Manual Hatching to match your drawing)
            ctx.save();
            ctx.beginPath();
            for(let t=0; t<=Math.PI; t+=0.01) {
                let r=4*Math.sin(t)*s; ctx.lineTo(ox+r*Math.cos(t-Math.PI/2), oy-r*Math.sin(t-Math.PI/2));
            }
            for(let t=Math.PI; t>=0; t-=0.01) {
                let r=2*Math.sin(t)*s; ctx.lineTo(ox+r*Math.cos(t-Math.PI/2), oy-r*Math.sin(t-Math.PI/2));
            }
            ctx.clip();
            ctx.beginPath();
            for(let i=-600; i<1200; i+=15) { ctx.moveTo(i, 0); ctx.lineTo(i-400, 600); }
            ctx.lineWidth = 1; ctx.stroke();
            ctx.restore();

            // 2. Main Circles & Axes
            ctx.lineWidth = 2;
            [4, 2].forEach(a => {
                ctx.beginPath();
                for(let t=0; t<=Math.PI; t+=0.01) {
                    let r=a*Math.sin(t)*s; ctx.lineTo(ox+r*Math.cos(t-Math.PI/2), oy-r*Math.sin(t-Math.PI/2));
                }
                ctx.stroke();
            });

            // Straight Lines (Vertical Axis and Horizontal Base)
            ctx.beginPath(); ctx.moveTo(ox, oy); ctx.lineTo(ox, 50); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(50, oy); ctx.lineTo(550, oy); ctx.stroke();

            // Line OPQ
            let ang = Math.PI/3, rP = 2*Math.sin(ang)*s, rQ = 4*Math.sin(ang)*s;
            let px = ox+rP*Math.cos(ang-Math.PI/2), py = oy-rP*Math.sin(ang-Math.PI/2);
            let qx = ox+rQ*Math.cos(ang-Math.PI/2), qy = oy-rQ*Math.sin(ang-Math.PI/2);
            ctx.beginPath(); ctx.moveTo(ox, oy); ctx.lineTo(qx, qy); ctx.stroke();

            // Dots
            [ {x:px, y:py}, {x:qx, y:qy} ].forEach(p => {
                ctx.beginPath(); ctx.arc(p.x, p.y, 5, 0, 7); ctx.fill();
            });

            // 3. Labelling (Exact placement)
            ctx.font = "italic 22px Times New Roman";
            ctx.fillText("O", ox - 10, oy + 30);
            ctx.fillText("P", px - 25, py);
            ctx.fillText("Q", qx - 25, qy - 5);
            ctx.fillText("r = 4 sin θ", qx + 10, qy - 5);
            ctx.fillText("r = 2 sin θ", px + 15, py + 15);
            ctx.fillText("θ = 0", ox + 180, oy - 10);
            ctx.fillText("θ = π", ox - 260, oy - 10);
        }

        function download() {
            const link = document.createElement('a');
            link.download = 'exact_diagram.png';
            link.href = canvas.toDataURL();
            link.click();
        }
        draw();
    </script>
</body>
</html>
